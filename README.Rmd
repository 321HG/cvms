---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# cvms
**Cross-Validation for Model Selection**  

R package: Cross-validating gaussian and binomial regression models.  

By Ludvig R. Olsen and Benjamin Zachariae,  
Cognitive Science, Aarhus University.  
Started in Oct. 2016 

Contact at:
r-pkgs@ludvigolsen.dk

Main functions:  

* cross_validate()
* cv_plot()

## Installation  

Development version:  

> install.packages("devtools")  
>
> devtools::install_github("LudvigOlsen/groupdata2")  
>
> devtools::install_github("LudvigOlsen/cvms")  


# Examples

## Attach packages
```{r warning=FALSE, message=FALSE}
library(cvms)
library(groupdata2) # fold()
library(knitr) # kable()
library(dplyr) # %>% arrange()
```

## Load data

The dataset participant.scores comes with cvms.

```{r}
data <- participant.scores
```

## Fold data

Create a grouping factor for subsetting in folds using groupdata2::fold(). Order the dataset by the folds.

```{r}
# Set seed for reproducibility
set.seed(7)

# Fold data 
data <- fold(data, k = 4,
             cat_col = 'diagnosis',
             id_col = 'participant') %>% 
  arrange(.folds)

# Show first 15 rows of data
data %>% head(15) %>% kable()
```

## Cross-validate a single model

### Gaussian

```{r}
CV1 <- cross_validate(data, "score~diagnosis", 
                     folds_col = '.folds', 
                     family='gaussian', 
                     REML = FALSE)

# Show results
CV1
```

### Binomial

```{r}
CV2 <- cross_validate(data, "diagnosis~score", 
                     folds_col = '.folds', 
                     family='binomial')

# Show results
CV2
```


## Cross-validate multiple models

### Describe model formulas

```{r}
models <- c("score~diagnosis","score~age")
mixed_models <- c("score~diagnosis+(1|session)","score~age+(1|session)")
```

### Cross-validate fixed effects models

```{r}
CV3 <- cross_validate(data, models, 
                     folds_col = '.folds', 
                     family='gaussian', 
                     REML = FALSE)

# Show results
CV3
```

### Cross-validate mixed effects models

```{r}
CV4 <- cross_validate(data, mixed_models, 
                     folds_col = '.folds', 
                     family='gaussian', 
                     REML = FALSE)

# Show results
CV4
```

## Plot results

### Gaussian

```{r}
cv_plot(CV1, type = "RMSE")
cv_plot(CV1, type = "r2")
cv_plot(CV1, type = "IC")
cv_plot(CV1, type = "coefficients")
```

### Binomial

```{r}
cv_plot(CV2, type = "ROC")
```


